local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer

-- Criar GUI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "MobileJoystick"
screenGui.ResetOnSpawn = false
screenGui.Parent = player:WaitForChild("PlayerGui")

-- Base do joystick
local base = Instance.new("Frame")
base.Size = UDim2.new(0, 150, 0, 150)
base.Position = UDim2.new(0, 50, 1, -200)
base.BackgroundColor3 = Color3.fromRGB(40,40,40)
base.BackgroundTransparency = 0.3
base.AnchorPoint = Vector2.new(0,1)
base.Parent = screenGui
base.Name = "Base"
base.UICorner = Instance.new("UICorner", base)
base.UICorner.CornerRadius = UDim.new(1,0)

-- BotÃ£o interno
local knob = Instance.new("Frame")
knob.Size = UDim2.new(0, 70, 0, 70)
knob.Position = UDim2.new(0.5, -35, 0.5, -35)
knob.BackgroundColor3 = Color3.fromRGB(255,255,255)
knob.BackgroundTransparency = 0.2
knob.Parent = base
knob.Name = "Knob"
knob.UICorner = Instance.new("UICorner", knob)
knob.UICorner.CornerRadius = UDim.new(1,0)

local dragging = false
local inputObject = nil
local joystickVector = Vector2.new(0,0)

local function updateKnob(inputPos)
	local center = base.AbsolutePosition + base.AbsoluteSize/2
	local delta = inputPos - center
	
	local radius = base.AbsoluteSize.X/2
	if delta.Magnitude > radius then
		delta = delta.Unit * radius
	end
	
	knob.Position = UDim2.new(
		0.5, delta.X - knob.AbsoluteSize.X/2,
		0.5, delta.Y - knob.AbsoluteSize.Y/2
	)
	
	joystickVector = Vector2.new(
		delta.X / radius,
		delta.Y / radius
	)
end

base.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.Touch then
		dragging = true
		inputObject = input
	end
end)

base.InputEnded:Connect(function(input)
	if input == inputObject then
		dragging = false
		inputObject = nil
		knob.Position = UDim2.new(0.5, -35, 0.5, -35)
		joystickVector = Vector2.new(0,0)
	end
end)

UserInputService.InputChanged:Connect(function(input)
	if dragging and input == inputObject then
		updateKnob(input.Position)
	end
end)

-- ðŸ”¥ EXEMPLO: Usando para voo legÃ­timo
local character = player.Character or player.CharacterAdded:Wait()
local root = character:WaitForChild("HumanoidRootPart")

local flying = true
local speed = 60

RunService.RenderStepped:Connect(function()
	if flying then
		local camera = workspace.CurrentCamera
		local forward = camera.CFrame.LookVector
		local right = camera.CFrame.RightVector
		
		local moveDirection = (forward * -joystickVector.Y) + (right * joystickVector.X)
		
		root.Velocity = moveDirection * speed
	end
end)
